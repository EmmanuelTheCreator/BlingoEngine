-- Copyright to EmmanuelTheCreator.com-- This file was written in 2005, yeah a lot has evolved since then :-)property mySubscribers,mySubscribersDataon new me  mySubscribers = []  mySubscribersData = []  return meendon subsribe me,_obj,function  if mySubscribers.getpos(_obj) then     return false    exit  end if  mySubscribers.append(_obj)  mySubscribersData.append([:])  mySubscribersData[mySubscribersData.count][#function] = function  Id = mySubscribers.getpos(_obj)  return Idendon subscibersGetAll me  return mySubscribersendon subscibersGetById me,val  if voidp(val) then exit  if not value(val) then exit  if val>mySubscribers.count or val<=1 then exit  return mySubscribers[val]endon executeAllSubscibed me,data  repeat with i=1 to mySubscribers.count    obj = mySubscribers[i]    funct = mySubscribersData[i][#function]    if obj.handler(funct) then      obj.ReturnFromSaveScore(data)--      obj.funct(data))    end if      end repeat  endon subscriberdestroy me  mySubscribers = []  mySubscribersData = []end
on new me  mySubscribers = []  mySubscribersData = []  return meendon subsribe me,_obj,function  if mySubscribers.getpos(_obj) then     return false    exit  end if  mySubscribers.append(_obj)  mySubscribersData.append([:])  mySubscribersData[mySubscribersData.count][#function] = function  Id = mySubscribers.getpos(_obj)  return Idendon subscibersGetAll me  return mySubscribersendon subscibersGetById me,val  if voidp(val) then exit  if not value(val) then exit  if val>mySubscribers.count or val<=1 then exit  return mySubscribers[val]endon executeAllSubscibed me,data  repeat with i=1 to mySubscribers.count    obj = mySubscribers[i]    funct = mySubscribersData[i][#function]    if obj.handler(funct) then      obj.ReturnFromSaveScore(data)--      obj.funct(data))    end if      end repeat  endon subscriberdestroy me  mySubscribers = []  mySubscribersData = []end